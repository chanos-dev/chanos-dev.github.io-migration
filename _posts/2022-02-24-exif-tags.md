---
date: 2022-02-24
layout: post
title:  "C# System.Drawing.Imageë¥¼ ì´ìš©í•œ Exif Tag ì‚¬ìš©"
description: "System.Drawing.Image - Exif Tag"
image: /assets/img/posts/image/csharp.png
optimized_image: /assets/img/posts/image/csharp.png
category: C Sharp
tags:
  - C#
  - .NET
  - exif
  - Winforms
author: chanos
---
>[Git Source](https://github.com/chanos-dev/blogcode/tree/master/22-0224){:target="_blank"}

---

ì•ˆë…•í•˜ì„¸ìš”. <b>chanos</b>ì…ë‹ˆë‹¤. ğŸ˜‰

ì˜¤ëŠ˜ì€ Exif Tagì— ê´€í•œ ê¸€ì…ë‹ˆë‹¤.

Jpegì— ë©”íƒ€ë°ì´í„°ë¥¼ ë„£ì–´ì•¼í•  ë•Œ Exif Tagë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°ìš”.

System.Drawing.Image ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ì„œ Exif Tagë¥¼ ì½ê³  ì“°ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

Imageì˜ ë©”íƒ€ë°ì´í„°ëŠ” PropertyItems ì†ì„±ì— ê´€ë¦¬ê°€ ë©ë‹ˆë‹¤.

PropertyItemsì˜ íƒ€ì…ì€ PropertyItem ê°ì²´ì˜ array í˜•ì‹ì´ë©°, ì¶”ê°€, ìˆ˜ì •, ì‚­ì œë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” Image ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œì¸ SetPropertyItem, RemovePropertyItemë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

PropertyItem ê°ì²´ì˜ ì†ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| Property  | Description |
| :------   | :----------- |
| [Id](https://docs.microsoft.com/ko-kr/dotnet/api/system.drawing.imaging.propertyitem.id?view=dotnet-plat-ext-6.0) | Exif Tagì˜ Id ê°’ |
| Len | Valueì˜ ê¸¸ì´   | 
| [Type](https://docs.microsoft.com/ko-kr/dotnet/api/system.drawing.imaging.propertyitem.type?view=dotnet-plat-ext-6.0#System_Drawing_Imaging_PropertyItem_Type) | Tag ë°ì´í„°ì˜ í˜•ì‹ |
| Value | ë°ì´í„° |

ìœ„ ê°ì²´ ë° ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```c#
// Artist Tag ì¶”ê°€

var img = Image.FromFile("star.jpg");

var propertyItem = img.PropertyItems[0];

// stringì¸ ê²½ìš° null ì¢…ê²°ì í•„ìš”
var val = Encoding.UTF8.GetBytes($"Tag Test!!\0");
propertyItem.Id = 0x013b; // Artist
propertyItem.Type = 2; // ascii stringì¸ ê²½ìš° typeì´ 2
propertyItem.Value = val;
propertyItem.Len = val.Length;

img.SetPropertyItem(propertyItem);
```

ìƒˆë¡œìš´ Tagë¥¼ ì‚½ì…í•´ì•¼ ë  ê²½ìš° PropertyItem ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ ë˜ëŠ”ë°, í•´ë‹¹ ê°ì²´ëŠ” Constructorê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë”ë¶ˆì–´ PropertyItemì€ sealed í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ ìƒì†ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

ê²€ìƒ‰ì„ í†µí•´ ìë£Œë¥¼ ì°¾ì•„ë³¸ê²°ê³¼ ìœ„ì™€ ê°™ì´ 0ë²ˆì§¸ ì¸ë±ìŠ¤ ê°ì²´ë¥¼ ê°€ì ¸ì™€ ì‚¬ìš©ì„ í•˜ëŠ”ë°ìš”.

ì´ë ‡ê²Œ ì‚¬ìš©í•  ê²½ìš° Id ê°’ì´ ê°™ì„ ë•ŒëŠ” ë®ì–´ì¨ì§€ê³ , ë‹¤ë¥´ë‹¤ë©´ ìƒˆë¡œìš´ PropertyItemì´ PropertyItemsì— ì¶”ê°€ë©ë‹ˆë‹¤.

ì •ìƒì ìœ¼ë¡œ ì‘ë™ì„ í•˜ê¸°ëŠ” í•˜ì§€ë§Œ ì½”ë“œë¡œë§Œ ë´¤ì„ ë•ŒëŠ” 0ë²ˆì§¸ ìš”ì†Œì˜ ê°’ì„ ìˆ˜ì •í•˜ëŠ” ê²ƒ ì²˜ëŸ¼ ë³´ì´ê¸° ë•Œë¬¸ì— Tagë¥¼ ì¶”ê°€í•œë‹¤ëŠ” í–‰ìœ„ê°€ ëª…í™•í•˜ì§€ ì•Šì€ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ FormatterServicesë¥¼ ì´ìš©í•˜ë©´ ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ”ë°ìš”.

FormatterServicesì˜ GetUninitializedObject ì •ì  ë©”ì„œë“œë¥¼ ì´ìš©í•˜ë©´ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³  0 or nullë¡œ ì´ˆê¸°í™”ëœ ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```c#
// Artist Tag ì¶”ê°€

var img = Image.FromFile("star.jpg");

var propertyItem = FormatterServices.GetUninitializedObject(typeof(PropertyItem)) as PropertyItem;

// stringì¸ ê²½ìš° null ì¢…ê²°ì í•„ìš”
var val = Encoding.UTF8.GetBytes($"Tag Test!!\0");
propertyItem.Id = 0x013b; // Artist
propertyItem.Type = 2; // ascii stringì¸ ê²½ìš° typeì´ 2
propertyItem.Value = val;
propertyItem.Len = val.Length;

img.SetPropertyItem(propertyItem);
```

ìœ„ì™€ ê°™ì´ ì‘ì„±í•œë‹¤ë©´ ìƒˆë¡œìš´ íƒœê·¸ë¥¼ ì¶”ê°€í•œë‹¤ëŠ” í–‰ìœ„ë¥¼ ëª…í™•í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ ì‹¶ìŠµë‹ˆë‹¤.

íƒœê·¸ë¥¼ ì‚­ì œí•˜ëŠ” ë°©ë²•ì€ RemovePropertyItem ë©”ì„œë“œë¥¼ ì´ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```c#
// Artist Tag ì‚­ì œ
img.RemovePropertyItem(0x013b);
```

![exif](/assets/img/posts/2022-02-24/exif.png)

---

## Reference

[C# PropertyItem](https://docs.microsoft.com/ko-kr/dotnet/api/system.drawing.imaging.propertyitem?view=dotnet-plat-ext-6.0){:target="_blank"}

[Exif Tags](https://exiftool.org/TagNames/EXIF.html){:target="_blank"}